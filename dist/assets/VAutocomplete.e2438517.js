import{da as j,ds as q,cR as z,cQ as Q,$ as y,aV as w,dt as Z,du as G,O as P,a0 as S,ak as x,u as H,a as t,at as L,dr as J,aF as A,dq as W,dl as E,aE as X,j as Y,cZ as ee,f as le,ad as ae,aT as te}from"./index.1a258bbd.js";import{m as ue,u as ne}from"./filter.e9e303b2.js";function se(e,c,n){if(Array.isArray(c))throw new Error("Multiple matches is not implemented");return typeof c=="number"&&~c?t(L,null,[t("span",{class:"v-autocomplete__unmask"},[e.substr(0,c)]),t("span",{class:"v-autocomplete__mask"},[e.substr(c,n)]),t("span",{class:"v-autocomplete__unmask"},[e.substr(c+n)])]):e}const re=j()({name:"VAutocomplete",props:{search:String,...ue({filterKeys:["title"]}),...q(),...z({transition:!1})},emits:{"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,c){let{slots:n}=c;const{t:O}=Q(),b=y(),d=y(!1),v=y(!0),s=w(e,"menu"),{items:_,transformIn:R,transformOut:M}=Z(e),o=w(e,"search",""),i=w(e,"modelValue",[],l=>R(G(l)),l=>{var a;const u=M(l);return e.multiple?u:(a=u[0])!=null?a:null}),{filteredItems:I}=ne(e,_,P(()=>v.value?void 0:o.value)),h=P(()=>i.value.map(l=>_.value.find(u=>u.value===l.value)||l)),D=P(()=>h.value.map(l=>l.props.value));function N(l){i.value=[],e.openOnClear&&(s.value=!0),o.value=""}function F(){e.hideNoData&&!_.value.length||e.readonly||(s.value=!0)}function $(l){e.readonly||(["Enter","ArrowDown"].includes(l.key)&&(s.value=!0),["Escape"].includes(l.key)&&(s.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(v.value=!0))}function K(l){o.value=l.target.value}function B(){d.value&&(v.value=!0)}const f=y(!1);function V(l){if(e.multiple){const u=D.value.findIndex(a=>a===l.value);if(u===-1)i.value=[...i.value,l],o.value="";else{const a=[...i.value];a.splice(u,1),i.value=a}}else i.value=[l],f.value=!0,o.value=l.title,s.value=!1,v.value=!0,x(()=>f.value=!1)}return S(d,l=>{var a;if(l){var u;f.value=!0,o.value=e.multiple?"":String((a=(u=h.value.at(-1))==null?void 0:u.props.title)!=null?a:""),v.value=!0,x(()=>f.value=!1)}else s.value=!1,o.value=""}),S(o,l=>{!d.value||f.value||(l&&(s.value=!0),v.value=!l)}),H(()=>{const l=!!(e.chips||n.chip);return t(ae,{ref:b,modelValue:o.value,"onUpdate:modelValue":u=>{u==null&&(i.value=[])},validationValue:i.externalValue,dirty:i.value.length>0,onInput:K,class:["v-autocomplete",{"v-autocomplete--active-menu":s.value,"v-autocomplete--chips":!!e.chips,[`v-autocomplete--${e.multiple?"multiple":"single"}`]:!0}],appendInnerIcon:e.menuIcon,readonly:e.readonly,"onClick:clear":N,"onClick:control":F,"onClick:input":F,onFocus:()=>d.value=!0,onBlur:()=>d.value=!1,onKeydown:$},{...n,default:()=>{var u;return t(L,null,[t(J,A({modelValue:s.value,"onUpdate:modelValue":a=>s.value=a,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:B},e.menuProps),{default:()=>[t(W,{selected:D.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault()},{default:()=>{var a;return[!I.value.length&&!e.hideNoData&&((a=(u=n["no-data"])==null?void 0:u.call(n))!=null?a:t(E,{title:O(e.noDataText)},null)),I.value.map((m,k)=>{var T;var p;let{item:r,matches:U}=m;return(T=(p=n.item)==null?void 0:p.call(n,{item:r,index:k,props:A(r.props,{onClick:()=>V(r)})}))!=null?T:t(E,A({key:k},r.props,{onClick:()=>V(r)}),{prepend:C=>{let{isSelected:g}=C;return e.multiple&&!e.hideSelected?t(X,{modelValue:g,ripple:!1},null):void 0},title:()=>{var g;var C;return v.value?r.title:se(r.title,U.title,(g=(C=o.value)==null?void 0:C.length)!=null?g:0)}})})]}})]}),h.value.map((a,m)=>{function k(r){r.stopPropagation(),r.preventDefault(),V(a)}const p={"onClick:close":k,modelValue:!0};return t("div",{key:m,class:"v-autocomplete__selection"},[l?t(Y,{defaults:{VChip:{closable:e.closableChips,size:"small",text:a.title}}},{default:()=>[n.chip?n.chip({item:a,index:m,props:p}):t(ee,p,null)]}):n.selection?n.selection({item:a,index:m}):t("span",{class:"v-autocomplete__selection-text"},[a.title,e.multiple&&m<h.value.length-1&&t("span",{class:"v-autocomplete__selection-comma"},[le(",")])])])})])}})}),te({isFocused:d,isPristine:v,menu:s,search:o,filteredItems:I,select:V},b)}});export{re as V};
